{{ define "title" }}Jobs{{ end }}

{{ define "head" }}
{{end}}

{{ define "navigation" }}
	<li class="nav-header">Navigation</li>
	<li><a href="/jobs">Jobs</a></li>
	<li class="active"><a href="/tasks">Tasks</a></li>
	<li><a href="/runs">Runs</a></li>
	<li class="nav-header">Actions</li>
	<li><a href="#add-task" role="button" data-toggle="modal">Add task</a></li>
{{ end }}

{{ define "content" }}

<h1>Tasks</h1>
{{ if not .GetList }}
	<p>There are not any tasks yet. You can <a href="#add-job" role="button" data-toggle="modal">add one now</a>!</p>
{{ else }}
	<table class="table">
		<thead>
		<tr>
			<th>Task</th>
		</tr>
		</thead>
		<tbody>
		{{ range .GetList }}
		<tr>
			<td><a href="/tasks/{{ .Name }}">{{ .Name }}</a></td>
		</tr>
		{{ end }}
		</tbody>
	</table>
	{{ end }}
{{ end }}

{{ define "bottom" }}
	<div id="add-task" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		<div class="modal-header">
			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
			<h3 id="myModalLabel">Add task</h3>
		</div>
		<div class="modal-body">
			<form name="add-task" action="/tasks" method="post">
				<label for="name">Name</label>
				<input type="text" name="name" id="name">
			</form>
		</div>
		<div class="modal-footer">
			<button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button>
			<button class="btn btn-primary" id="add-task-submit">Add</button>
		</div>
	</div>
{{ end }}

{{ define "scripts" }}
<script type="text/javascript">
	$('#add-task-submit').click(function(){
		var name = $('#name').val();
		var ajax = $.ajax({
			url: "/tasks",
			type: "post",
			data: {name:name}
		});

		ajax.done(function(evt){
			window.location = "/tasks/" + name;
		});

		ajax.fail(function(d){
			alert(d.responseText);
		});
	})
</script>
{{ end }}